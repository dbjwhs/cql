<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Claude Query Language: cql::cli Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Claude Query Language<span id="projectnumber">&#160;1.0.0</span>
   </div>
   <div id="projectbrief">A compiler for generating Claude queries</div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('namespacecql_1_1cli.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">cql::cli Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0f22876055e0d52c47ae73210dbd3b38" id="r_a0f22876055e0d52c47ae73210dbd3b38"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0f22876055e0d52c47ae73210dbd3b38">run_interactive</a> ()</td></tr>
<tr class="separator:a0f22876055e0d52c47ae73210dbd3b38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05b7b9dfc28c7d52d65f69d1d7102d5a" id="r_a05b7b9dfc28c7d52d65f69d1d7102d5a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a05b7b9dfc28c7d52d65f69d1d7102d5a">process_file</a> (const std::string &amp;input_file, const std::string &amp;output_file)</td></tr>
<tr class="separator:a05b7b9dfc28c7d52d65f69d1d7102d5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f98414c44d3d71874aa60c8868fdcfe" id="r_a0f98414c44d3d71874aa60c8868fdcfe"><td class="memItemLeft" align="right" valign="top">Config&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0f98414c44d3d71874aa60c8868fdcfe">prepare_api_config</a> (const std::string &amp;model, const std::string &amp;output_dir, bool overwrite, bool create_dirs, bool no_save)</td></tr>
<tr class="separator:a0f98414c44d3d71874aa60c8868fdcfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abda5e00509ddaa5072d7aae3ed5e4380" id="r_abda5e00509ddaa5072d7aae3ed5e4380"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abda5e00509ddaa5072d7aae3ed5e4380">compile_query_for_api</a> (const std::string &amp;input_file)</td></tr>
<tr class="separator:abda5e00509ddaa5072d7aae3ed5e4380"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae821ee6e0823797bed800b41db27f4ce" id="r_ae821ee6e0823797bed800b41db27f4ce"><td class="memItemLeft" align="right" valign="top">ApiResponse&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae821ee6e0823797bed800b41db27f4ce">submit_to_api</a> (const std::string &amp;compiled_query, const Config &amp;config)</td></tr>
<tr class="separator:ae821ee6e0823797bed800b41db27f4ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a326f34bdb8c7a21bd577f7a6d072654c" id="r_a326f34bdb8c7a21bd577f7a6d072654c"><td class="memItemLeft" align="right" valign="top">std::vector&lt; GeneratedFile &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a326f34bdb8c7a21bd577f7a6d072654c">process_api_response</a> (const ApiResponse &amp;response, const Config &amp;config)</td></tr>
<tr class="separator:a326f34bdb8c7a21bd577f7a6d072654c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b229a6d1cbd174fe79d903ee74dcbab" id="r_a7b229a6d1cbd174fe79d903ee74dcbab"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7b229a6d1cbd174fe79d903ee74dcbab">save_generated_files</a> (const std::vector&lt; GeneratedFile &gt; &amp;files, const Config &amp;config)</td></tr>
<tr class="separator:a7b229a6d1cbd174fe79d903ee74dcbab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a124cbfdb64086acc7c36d2d79df790f1" id="r_a124cbfdb64086acc7c36d2d79df790f1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a124cbfdb64086acc7c36d2d79df790f1">process_submit_command</a> (const std::string &amp;input_file, const std::string &amp;output_dir, const std::string &amp;model, bool overwrite, bool create_dirs, bool no_save)</td></tr>
<tr class="separator:a124cbfdb64086acc7c36d2d79df790f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="abda5e00509ddaa5072d7aae3ed5e4380" name="abda5e00509ddaa5072d7aae3ed5e4380"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abda5e00509ddaa5072d7aae3ed5e4380">&#9670;&#160;</a></span>compile_query_for_api()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string cql::cli::compile_query_for_api </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em>input_file</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cli_8cpp_source.html#l00821">821</a> of file <a class="el" href="cli_8cpp_source.html">cli.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  821</span>                                                             {</div>
<div class="line"><span class="lineno">  822</span>    Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Compiling query from: &quot;</span>, input_file);</div>
<div class="line"><span class="lineno">  823</span>    std::string query_content = <a class="code hl_function" href="namespacecql_1_1util.html#a67627b43a128d9b6dd939fc3efdc16c7">util::read_file</a>(input_file);</div>
<div class="line"><span class="lineno">  824</span>    std::string compiled_query = QueryProcessor::compile(query_content);</div>
<div class="line"><span class="lineno">  825</span>    Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Query compiled successfully&quot;</span>);</div>
<div class="line"><span class="lineno">  826</span>    <span class="keywordflow">return</span> compiled_query;</div>
<div class="line"><span class="lineno">  827</span>}</div>
<div class="ttc" id="anamespacecql_1_1util_html_a67627b43a128d9b6dd939fc3efdc16c7"><div class="ttname"><a href="namespacecql_1_1util.html#a67627b43a128d9b6dd939fc3efdc16c7">cql::util::read_file</a></div><div class="ttdeci">std::string read_file(const std::string &amp;filepath)</div><div class="ttdef"><b>Definition</b> <a href="util_8cpp_source.html#l00015">util.cpp:15</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="util_8cpp_source.html#l00015">cql::util::read_file()</a>.</p>

<p class="reference">Referenced by <a class="el" href="cli_8cpp_source.html#l00889">process_submit_command()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><!-- SVG 0 --></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><!-- SVG 1 --></div>
</div>

</div>
</div>
<a id="a0f98414c44d3d71874aa60c8868fdcfe" name="a0f98414c44d3d71874aa60c8868fdcfe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f98414c44d3d71874aa60c8868fdcfe">&#9670;&#160;</a></span>prepare_api_config()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Config cql::cli::prepare_api_config </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em>model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em>output_dir</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>overwrite</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>create_dirs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>no_save</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cli_8cpp_source.html#l00798">798</a> of file <a class="el" href="cli_8cpp_source.html">cli.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  798</span>                                                                                                                               {</div>
<div class="line"><span class="lineno">  799</span>    <span class="comment">// Load the configuration</span></div>
<div class="line"><span class="lineno">  800</span>    Config config = Config::load_from_default_locations();</div>
<div class="line"><span class="lineno">  801</span>    </div>
<div class="line"><span class="lineno">  802</span>    <span class="comment">// Override with command-line arguments</span></div>
<div class="line"><span class="lineno">  803</span>    <span class="keywordflow">if</span> (!model.empty()) {</div>
<div class="line"><span class="lineno">  804</span>        config.set_model(model);</div>
<div class="line"><span class="lineno">  805</span>        Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Using model: &quot;</span>, model);</div>
<div class="line"><span class="lineno">  806</span>    }</div>
<div class="line"><span class="lineno">  807</span>    </div>
<div class="line"><span class="lineno">  808</span>    <span class="keywordflow">if</span> (!output_dir.empty()) {</div>
<div class="line"><span class="lineno">  809</span>        config.set_output_directory(output_dir);</div>
<div class="line"><span class="lineno">  810</span>        Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Output directory: &quot;</span>, output_dir);</div>
<div class="line"><span class="lineno">  811</span>    }</div>
<div class="line"><span class="lineno">  812</span>    </div>
<div class="line"><span class="lineno">  813</span>    config.set_overwrite_existing_files(overwrite);</div>
<div class="line"><span class="lineno">  814</span>    config.set_create_missing_directories(create_dirs);</div>
<div class="line"><span class="lineno">  815</span>    config.set_no_save_mode(no_save);</div>
<div class="line"><span class="lineno">  816</span>    </div>
<div class="line"><span class="lineno">  817</span>    <span class="keywordflow">return</span> config;</div>
<div class="line"><span class="lineno">  818</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="cli_8cpp_source.html#l00889">process_submit_command()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><!-- SVG 2 --></div>
</div>

</div>
</div>
<a id="a326f34bdb8c7a21bd577f7a6d072654c" name="a326f34bdb8c7a21bd577f7a6d072654c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a326f34bdb8c7a21bd577f7a6d072654c">&#9670;&#160;</a></span>process_api_response()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; GeneratedFile &gt; cql::cli::process_api_response </td>
          <td>(</td>
          <td class="paramtype">const ApiResponse &amp;</td>          <td class="paramname"><span class="paramname"><em>response</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Config &amp;</td>          <td class="paramname"><span class="paramname"><em>config</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cli_8cpp_source.html#l00849">849</a> of file <a class="el" href="cli_8cpp_source.html">cli.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  849</span>                                                                                                 {</div>
<div class="line"><span class="lineno">  850</span>    ResponseProcessor processor(config);</div>
<div class="line"><span class="lineno">  851</span>    std::vector&lt;GeneratedFile&gt; files = processor.process_response(response.m_raw_response);</div>
<div class="line"><span class="lineno">  852</span>    </div>
<div class="line"><span class="lineno">  853</span>    Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Generated &quot;</span>, files.size(), <span class="stringliteral">&quot; files:&quot;</span>);</div>
<div class="line"><span class="lineno">  854</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;Generated &quot;</span> &lt;&lt; files.size() &lt;&lt; <span class="stringliteral">&quot; files:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  855</span>    </div>
<div class="line"><span class="lineno">  856</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; file : files) {</div>
<div class="line"><span class="lineno">  857</span>        Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;- &quot;</span>, file.m_filename);</div>
<div class="line"><span class="lineno">  858</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;  - &quot;</span> &lt;&lt; file.m_filename &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  859</span>    }</div>
<div class="line"><span class="lineno">  860</span>    </div>
<div class="line"><span class="lineno">  861</span>    <span class="keywordflow">return</span> files;</div>
<div class="line"><span class="lineno">  862</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="cli_8cpp_source.html#l00889">process_submit_command()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><!-- SVG 3 --></div>
</div>

</div>
</div>
<a id="a05b7b9dfc28c7d52d65f69d1d7102d5a" name="a05b7b9dfc28c7d52d65f69d1d7102d5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05b7b9dfc28c7d52d65f69d1d7102d5a">&#9670;&#160;</a></span>process_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool cql::cli::process_file </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em>input_file</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em>output_file</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cli_8cpp_source.html#l00771">771</a> of file <a class="el" href="cli_8cpp_source.html">cli.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  771</span>                                                                             {</div>
<div class="line"><span class="lineno">  772</span>    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  773</span>        Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Processing file: &quot;</span>, input_file);</div>
<div class="line"><span class="lineno">  774</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Processing file: &quot;</span> &lt;&lt; input_file &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  775</span> </div>
<div class="line"><span class="lineno">  776</span>        <span class="keyword">const</span> std::string result = QueryProcessor::compile_file(input_file);</div>
<div class="line"><span class="lineno">  777</span> </div>
<div class="line"><span class="lineno">  778</span>        <span class="keywordflow">if</span> (output_file.empty()) {</div>
<div class="line"><span class="lineno">  779</span>            std::cout &lt;&lt; <span class="stringliteral">&quot;\nCompiled Query\n&quot;</span>;</div>
<div class="line"><span class="lineno">  780</span>            std::cout &lt;&lt; <span class="stringliteral">&quot;==============\n\n&quot;</span>;</div>
<div class="line"><span class="lineno">  781</span>            std::cout &lt;&lt; result &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  782</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  783</span>            <a class="code hl_function" href="namespacecql_1_1util.html#a61d0a7a06eb7c79b61f04c06e79dcd87">util::write_file</a>(output_file, result);</div>
<div class="line"><span class="lineno">  784</span>            std::cout &lt;&lt; <span class="stringliteral">&quot;Compiled query written to &quot;</span> &lt;&lt; output_file &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  785</span>            Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Compiled query written to &quot;</span>, output_file);</div>
<div class="line"><span class="lineno">  786</span>        }</div>
<div class="line"><span class="lineno">  787</span> </div>
<div class="line"><span class="lineno">  788</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  789</span>    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno">  790</span>        std::cerr &lt;&lt; <span class="stringliteral">&quot;Error processing file: &quot;</span> &lt;&lt; e.what() &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  791</span>        Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;Error processing file: &quot;</span>, e.what());</div>
<div class="line"><span class="lineno">  792</span> </div>
<div class="line"><span class="lineno">  793</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  794</span>    }</div>
<div class="line"><span class="lineno">  795</span>}</div>
<div class="ttc" id="anamespacecql_1_1util_html_a61d0a7a06eb7c79b61f04c06e79dcd87"><div class="ttname"><a href="namespacecql_1_1util.html#a61d0a7a06eb7c79b61f04c06e79dcd87">cql::util::write_file</a></div><div class="ttdeci">void write_file(const std::string &amp;filepath, const std::string &amp;content)</div><div class="ttdef"><b>Definition</b> <a href="util_8cpp_source.html#l00023">util.cpp:23</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="util_8cpp_source.html#l00023">cql::util::write_file()</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8cpp_source.html#l00044">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><!-- SVG 4 --></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><!-- SVG 5 --></div>
</div>

</div>
</div>
<a id="a124cbfdb64086acc7c36d2d79df790f1" name="a124cbfdb64086acc7c36d2d79df790f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a124cbfdb64086acc7c36d2d79df790f1">&#9670;&#160;</a></span>process_submit_command()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool cql::cli::process_submit_command </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em>input_file</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em>output_dir</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em>model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>overwrite</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>create_dirs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>no_save</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cli_8cpp_source.html#l00889">889</a> of file <a class="el" href="cli_8cpp_source.html">cli.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  894</span>                                        {</div>
<div class="line"><span class="lineno">  895</span>    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  896</span>        <span class="comment">// Prepare the configuration</span></div>
<div class="line"><span class="lineno">  897</span>        Config config = <a class="code hl_function" href="#a0f98414c44d3d71874aa60c8868fdcfe">prepare_api_config</a>(model, output_dir, overwrite, create_dirs, no_save);</div>
<div class="line"><span class="lineno">  898</span>        </div>
<div class="line"><span class="lineno">  899</span>        <span class="comment">// Compile the query</span></div>
<div class="line"><span class="lineno">  900</span>        std::string compiled_query = <a class="code hl_function" href="#abda5e00509ddaa5072d7aae3ed5e4380">compile_query_for_api</a>(input_file);</div>
<div class="line"><span class="lineno">  901</span>        </div>
<div class="line"><span class="lineno">  902</span>        <span class="comment">// Submit to API</span></div>
<div class="line"><span class="lineno">  903</span>        ApiResponse response = <a class="code hl_function" href="#ae821ee6e0823797bed800b41db27f4ce">submit_to_api</a>(compiled_query, config);</div>
<div class="line"><span class="lineno">  904</span>        <span class="keywordflow">if</span> (!response.m_success) {</div>
<div class="line"><span class="lineno">  905</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  906</span>        }</div>
<div class="line"><span class="lineno">  907</span>        </div>
<div class="line"><span class="lineno">  908</span>        <span class="comment">// Process the response</span></div>
<div class="line"><span class="lineno">  909</span>        std::vector&lt;GeneratedFile&gt; files = <a class="code hl_function" href="#a326f34bdb8c7a21bd577f7a6d072654c">process_api_response</a>(response, config);</div>
<div class="line"><span class="lineno">  910</span>        </div>
<div class="line"><span class="lineno">  911</span>        <span class="comment">// Save files</span></div>
<div class="line"><span class="lineno">  912</span>        <a class="code hl_function" href="#a7b229a6d1cbd174fe79d903ee74dcbab">save_generated_files</a>(files, config);</div>
<div class="line"><span class="lineno">  913</span>        </div>
<div class="line"><span class="lineno">  914</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  915</span>    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno">  916</span>        Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;Error processing submit command: &quot;</span>, e.what());</div>
<div class="line"><span class="lineno">  917</span>        std::cerr &lt;&lt; <span class="stringliteral">&quot;Error processing submit command: &quot;</span> &lt;&lt; e.what() &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  918</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  919</span>    }</div>
<div class="line"><span class="lineno">  920</span>}</div>
<div class="ttc" id="anamespacecql_1_1cli_html_a0f98414c44d3d71874aa60c8868fdcfe"><div class="ttname"><a href="#a0f98414c44d3d71874aa60c8868fdcfe">cql::cli::prepare_api_config</a></div><div class="ttdeci">Config prepare_api_config(const std::string &amp;model, const std::string &amp;output_dir, bool overwrite, bool create_dirs, bool no_save)</div><div class="ttdef"><b>Definition</b> <a href="cli_8cpp_source.html#l00798">cli.cpp:798</a></div></div>
<div class="ttc" id="anamespacecql_1_1cli_html_a326f34bdb8c7a21bd577f7a6d072654c"><div class="ttname"><a href="#a326f34bdb8c7a21bd577f7a6d072654c">cql::cli::process_api_response</a></div><div class="ttdeci">std::vector&lt; GeneratedFile &gt; process_api_response(const ApiResponse &amp;response, const Config &amp;config)</div><div class="ttdef"><b>Definition</b> <a href="cli_8cpp_source.html#l00849">cli.cpp:849</a></div></div>
<div class="ttc" id="anamespacecql_1_1cli_html_a7b229a6d1cbd174fe79d903ee74dcbab"><div class="ttname"><a href="#a7b229a6d1cbd174fe79d903ee74dcbab">cql::cli::save_generated_files</a></div><div class="ttdeci">void save_generated_files(const std::vector&lt; GeneratedFile &gt; &amp;files, const Config &amp;config)</div><div class="ttdef"><b>Definition</b> <a href="cli_8cpp_source.html#l00865">cli.cpp:865</a></div></div>
<div class="ttc" id="anamespacecql_1_1cli_html_abda5e00509ddaa5072d7aae3ed5e4380"><div class="ttname"><a href="#abda5e00509ddaa5072d7aae3ed5e4380">cql::cli::compile_query_for_api</a></div><div class="ttdeci">std::string compile_query_for_api(const std::string &amp;input_file)</div><div class="ttdef"><b>Definition</b> <a href="cli_8cpp_source.html#l00821">cli.cpp:821</a></div></div>
<div class="ttc" id="anamespacecql_1_1cli_html_ae821ee6e0823797bed800b41db27f4ce"><div class="ttname"><a href="#ae821ee6e0823797bed800b41db27f4ce">cql::cli::submit_to_api</a></div><div class="ttdeci">ApiResponse submit_to_api(const std::string &amp;compiled_query, const Config &amp;config)</div><div class="ttdef"><b>Definition</b> <a href="cli_8cpp_source.html#l00830">cli.cpp:830</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="cli_8cpp_source.html#l00821">compile_query_for_api()</a>, <a class="el" href="cli_8cpp_source.html#l00798">prepare_api_config()</a>, <a class="el" href="cli_8cpp_source.html#l00849">process_api_response()</a>, <a class="el" href="cli_8cpp_source.html#l00865">save_generated_files()</a>, and <a class="el" href="cli_8cpp_source.html#l00830">submit_to_api()</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8cpp_source.html#l00044">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><!-- SVG 6 --></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><!-- SVG 7 --></div>
</div>

</div>
</div>
<a id="a0f22876055e0d52c47ae73210dbd3b38" name="a0f22876055e0d52c47ae73210dbd3b38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f22876055e0d52c47ae73210dbd3b38">&#9670;&#160;</a></span>run_interactive()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cql::cli::run_interactive </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cli_8cpp_source.html#l00023">23</a> of file <a class="el" href="cli_8cpp_source.html">cli.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   23</span>                       {</div>
<div class="line"><span class="lineno">   24</span>    Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;CQL Interactive Mode&quot;</span>);</div>
<div class="line"><span class="lineno">   25</span>    Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Type &#39;exit&#39; to quit, &#39;help&#39; for command list&quot;</span>);</div>
<div class="line"><span class="lineno">   26</span> </div>
<div class="line"><span class="lineno">   27</span>    std::string line;</div>
<div class="line"><span class="lineno">   28</span>    std::string current_query;</div>
<div class="line"><span class="lineno">   29</span>    TemplateManager template_manager;</div>
<div class="line"><span class="lineno">   30</span>    </div>
<div class="line"><span class="lineno">   31</span>    <span class="comment">// create template validator with default schema</span></div>
<div class="line"><span class="lineno">   32</span>    TemplateValidator template_validator(template_manager);</div>
<div class="line"><span class="lineno">   33</span>    <span class="keyword">auto</span> schema = TemplateValidatorSchema::create_default_schema();</div>
<div class="line"><span class="lineno">   34</span>    </div>
<div class="line"><span class="lineno">   35</span>    <span class="comment">// add schema validation rules</span></div>
<div class="line"><span class="lineno">   36</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [name, rule] : schema.get_validation_rules()) {</div>
<div class="line"><span class="lineno">   37</span>        template_validator.add_validation_rule(rule);</div>
<div class="line"><span class="lineno">   38</span>    }</div>
<div class="line"><span class="lineno">   39</span>    </div>
<div class="line"><span class="lineno">   40</span>    <span class="comment">// store variables in memory for template instantiation</span></div>
<div class="line"><span class="lineno">   41</span>    std::map&lt;std::string, std::string&gt; current_variables;</div>
<div class="line"><span class="lineno">   42</span> </div>
<div class="line"><span class="lineno">   43</span>    <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno">   44</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt; &quot;</span>;</div>
<div class="line"><span class="lineno">   45</span>        std::getline(std::cin, line);</div>
<div class="line"><span class="lineno">   46</span> </div>
<div class="line"><span class="lineno">   47</span>        <span class="keywordflow">if</span> (line == <span class="stringliteral">&quot;exit&quot;</span> || line == <span class="stringliteral">&quot;quit&quot;</span>) {</div>
<div class="line"><span class="lineno">   48</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   49</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line == <span class="stringliteral">&quot;help&quot;</span>) {</div>
<div class="line"><span class="lineno">   50</span>            std::cout &lt;&lt; <span class="stringliteral">&quot;Commands:\n&quot;</span></div>
<div class="line"><span class="lineno">   51</span>                      &lt;&lt; <span class="stringliteral">&quot;  help                    - Show this help\n&quot;</span></div>
<div class="line"><span class="lineno">   52</span>                      &lt;&lt; <span class="stringliteral">&quot;  exit/quit               - Exit the program\n&quot;</span></div>
<div class="line"><span class="lineno">   53</span>                      &lt;&lt; <span class="stringliteral">&quot;  clear                   - Clear the current query\n&quot;</span></div>
<div class="line"><span class="lineno">   54</span>                      &lt;&lt; <span class="stringliteral">&quot;  show                    - Show the current query\n&quot;</span></div>
<div class="line"><span class="lineno">   55</span>                      &lt;&lt; <span class="stringliteral">&quot;  compile                 - Compile the current query\n&quot;</span></div>
<div class="line"><span class="lineno">   56</span>                      &lt;&lt; <span class="stringliteral">&quot;  load FILE               - Load query from file\n&quot;</span></div>
<div class="line"><span class="lineno">   57</span>                      &lt;&lt; <span class="stringliteral">&quot;  save FILE               - Save compiled query to file\n&quot;</span></div>
<div class="line"><span class="lineno">   58</span>                      &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><span class="lineno">   59</span>                      &lt;&lt; <span class="stringliteral">&quot;Template Commands:\n&quot;</span></div>
<div class="line"><span class="lineno">   60</span>                      &lt;&lt; <span class="stringliteral">&quot;  templates               - List all available templates\n&quot;</span></div>
<div class="line"><span class="lineno">   61</span>                      &lt;&lt; <span class="stringliteral">&quot;  template save NAME      - Save current query as a template\n&quot;</span></div>
<div class="line"><span class="lineno">   62</span>                      &lt;&lt; <span class="stringliteral">&quot;  template load NAME      - Load a template\n&quot;</span></div>
<div class="line"><span class="lineno">   63</span>                      &lt;&lt; <span class="stringliteral">&quot;  template info NAME      - Show info about a template\n&quot;</span></div>
<div class="line"><span class="lineno">   64</span>                      &lt;&lt; <span class="stringliteral">&quot;  template delete NAME    - Delete a template\n&quot;</span></div>
<div class="line"><span class="lineno">   65</span>                      &lt;&lt; <span class="stringliteral">&quot;  template vars NAME      - List variables in a template\n&quot;</span></div>
<div class="line"><span class="lineno">   66</span>                      &lt;&lt; <span class="stringliteral">&quot;  template setvar NAME=VAL - Set a template variable\n&quot;</span></div>
<div class="line"><span class="lineno">   67</span>                      &lt;&lt; <span class="stringliteral">&quot;  template setvars        - Enter multiple variables interactively\n&quot;</span></div>
<div class="line"><span class="lineno">   68</span>                      &lt;&lt; <span class="stringliteral">&quot;  template vars           - Show current variables in memory\n&quot;</span></div>
<div class="line"><span class="lineno">   69</span>                      &lt;&lt; <span class="stringliteral">&quot;  template clearvars      - Clear all current variables\n&quot;</span></div>
<div class="line"><span class="lineno">   70</span>                      &lt;&lt; <span class="stringliteral">&quot;  template use NAME       - Use a template with current variables\n&quot;</span></div>
<div class="line"><span class="lineno">   71</span>                      &lt;&lt; <span class="stringliteral">&quot;  template dir [PATH]     - Show or set templates directory\n&quot;</span></div>
<div class="line"><span class="lineno">   72</span>                      &lt;&lt; <span class="stringliteral">&quot;  template inherit CHILD PARENT - Create a template inheriting from another\n&quot;</span></div>
<div class="line"><span class="lineno">   73</span>                      &lt;&lt; <span class="stringliteral">&quot;  template parents NAME   - Show inheritance chain for a template\n&quot;</span></div>
<div class="line"><span class="lineno">   74</span>                      &lt;&lt; <span class="stringliteral">&quot;  template validate NAME  - Validate a template\n&quot;</span></div>
<div class="line"><span class="lineno">   75</span>                      &lt;&lt; <span class="stringliteral">&quot;  template validateall    - Validate all templates\n&quot;</span></div>
<div class="line"><span class="lineno">   76</span>                      &lt;&lt; <span class="stringliteral">&quot;  template docs NAME      - Generate documentation for a template\n&quot;</span></div>
<div class="line"><span class="lineno">   77</span>                      &lt;&lt; <span class="stringliteral">&quot;  template docsall        - Generate documentation for all templates\n&quot;</span></div>
<div class="line"><span class="lineno">   78</span>                      &lt;&lt; <span class="stringliteral">&quot;  template export PATH [format] - Export documentation to a file (formats: md, html, txt)\n&quot;</span></div>
<div class="line"><span class="lineno">   79</span>                      &lt;&lt; <span class="stringliteral">&quot;  categories              - List template categories\n&quot;</span></div>
<div class="line"><span class="lineno">   80</span>                      &lt;&lt; <span class="stringliteral">&quot;  category create NAME    - Create a new template category\n&quot;</span>;</div>
<div class="line"><span class="lineno">   81</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line == <span class="stringliteral">&quot;clear&quot;</span>) {</div>
<div class="line"><span class="lineno">   82</span>            current_query.clear();</div>
<div class="line"><span class="lineno">   83</span>            Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Query cleared&quot;</span>);</div>
<div class="line"><span class="lineno">   84</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line == <span class="stringliteral">&quot;show&quot;</span>) {</div>
<div class="line"><span class="lineno">   85</span>            <span class="keywordflow">if</span> (current_query.empty()) {</div>
<div class="line"><span class="lineno">   86</span>                Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Current query is empty&quot;</span>);</div>
<div class="line"><span class="lineno">   87</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   88</span>                Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Current query:\n&quot;</span>, current_query);</div>
<div class="line"><span class="lineno">   89</span>            }</div>
<div class="line"><span class="lineno">   90</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line == <span class="stringliteral">&quot;compile&quot;</span>) {</div>
<div class="line"><span class="lineno">   91</span>            <span class="keywordflow">if</span> (current_query.empty()) {</div>
<div class="line"><span class="lineno">   92</span>                Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;Nothing to compile&quot;</span>);</div>
<div class="line"><span class="lineno">   93</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">   94</span>            }</div>
<div class="line"><span class="lineno">   95</span> </div>
<div class="line"><span class="lineno">   96</span>            <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">   97</span>                std::string result = QueryProcessor::compile(current_query);</div>
<div class="line"><span class="lineno">   98</span>                Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;\n=== Compiled Query ===\n\n&quot;</span>, </div>
<div class="line"><span class="lineno">   99</span>                                         result, <span class="stringliteral">&quot;\n===================&quot;</span>);</div>
<div class="line"><span class="lineno">  100</span>            } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno">  101</span>                Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;Compilation error: &quot;</span>, e.what());</div>
<div class="line"><span class="lineno">  102</span>            }</div>
<div class="line"><span class="lineno">  103</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line.substr(0, 5) == <span class="stringliteral">&quot;load &quot;</span>) {</div>
<div class="line"><span class="lineno">  104</span>            std::string filename = line.substr(5);</div>
<div class="line"><span class="lineno">  105</span>            <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  106</span>                current_query = <a class="code hl_function" href="namespacecql_1_1util.html#a67627b43a128d9b6dd939fc3efdc16c7">util::read_file</a>(filename);</div>
<div class="line"><span class="lineno">  107</span>                Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Loaded query from &quot;</span>, filename);</div>
<div class="line"><span class="lineno">  108</span>            } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno">  109</span>                Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;Failed to load file: &quot;</span>, e.what());</div>
<div class="line"><span class="lineno">  110</span>            }</div>
<div class="line"><span class="lineno">  111</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line.substr(0, 5) == <span class="stringliteral">&quot;save &quot;</span>) {</div>
<div class="line"><span class="lineno">  112</span>            std::string filename = line.substr(5);</div>
<div class="line"><span class="lineno">  113</span>            <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  114</span>                <span class="keywordflow">if</span> (current_query.empty()) {</div>
<div class="line"><span class="lineno">  115</span>                    Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;Nothing to save&quot;</span>);</div>
<div class="line"><span class="lineno">  116</span>                    <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  117</span>                }</div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span>                QueryProcessor::save_compiled(current_query, filename);</div>
<div class="line"><span class="lineno">  120</span>                Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Saved compiled query to &quot;</span>, filename);</div>
<div class="line"><span class="lineno">  121</span>            } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno">  122</span>                Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;Failed to save file: &quot;</span>, e.what());</div>
<div class="line"><span class="lineno">  123</span>            }</div>
<div class="line"><span class="lineno">  124</span>        } </div>
<div class="line"><span class="lineno">  125</span>        <span class="comment">// template management commands</span></div>
<div class="line"><span class="lineno">  126</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line == <span class="stringliteral">&quot;templates&quot;</span>) {</div>
<div class="line"><span class="lineno">  127</span>            <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  128</span>                <span class="keyword">auto</span> templates = template_manager.list_templates();</div>
<div class="line"><span class="lineno">  129</span>                <span class="keywordflow">if</span> (templates.empty()) {</div>
<div class="line"><span class="lineno">  130</span>                    Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;No templates found&quot;</span>);</div>
<div class="line"><span class="lineno">  131</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  132</span>                    Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Available templates:&quot;</span>);</div>
<div class="line"><span class="lineno">  133</span>                    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; tmpl : templates) {</div>
<div class="line"><span class="lineno">  134</span>                        std::cout &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; tmpl &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  135</span>                    }</div>
<div class="line"><span class="lineno">  136</span>                }</div>
<div class="line"><span class="lineno">  137</span>            } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno">  138</span>                Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;Error listing templates: &quot;</span>, e.what());</div>
<div class="line"><span class="lineno">  139</span>            }</div>
<div class="line"><span class="lineno">  140</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line.substr(0, 14) == <span class="stringliteral">&quot;template save &quot;</span>) {</div>
<div class="line"><span class="lineno">  141</span>            std::string name = line.substr(14);</div>
<div class="line"><span class="lineno">  142</span>            <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  143</span>                <span class="keywordflow">if</span> (current_query.empty()) {</div>
<div class="line"><span class="lineno">  144</span>                    Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;Cannot save empty template&quot;</span>);</div>
<div class="line"><span class="lineno">  145</span>                    <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  146</span>                }</div>
<div class="line"><span class="lineno">  147</span> </div>
<div class="line"><span class="lineno">  148</span>                <span class="comment">// validate the template before saving</span></div>
<div class="line"><span class="lineno">  149</span>                <span class="keyword">auto</span> validation_result = template_validator.validate_content(current_query);</div>
<div class="line"><span class="lineno">  150</span>                </div>
<div class="line"><span class="lineno">  151</span>                <span class="comment">// check for validation errors</span></div>
<div class="line"><span class="lineno">  152</span>                <span class="keywordflow">if</span> (validation_result.has_issues(TemplateValidationLevel::ERROR)) {</div>
<div class="line"><span class="lineno">  153</span>                    Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;Template validation failed with errors:&quot;</span>);</div>
<div class="line"><span class="lineno">  154</span>                    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; issue : validation_result.get_issues(TemplateValidationLevel::ERROR)) {</div>
<div class="line"><span class="lineno">  155</span>                        std::cout &lt;&lt; <span class="stringliteral">&quot;  - &quot;</span> &lt;&lt; issue.to_string() &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  156</span>                    }</div>
<div class="line"><span class="lineno">  157</span>                    </div>
<div class="line"><span class="lineno">  158</span>                    std::cout &lt;&lt; <span class="stringliteral">&quot;Do you want to save the template anyway? (y/n): &quot;</span>;</div>
<div class="line"><span class="lineno">  159</span>                    std::string response;</div>
<div class="line"><span class="lineno">  160</span>                    std::getline(std::cin, response);</div>
<div class="line"><span class="lineno">  161</span>                    </div>
<div class="line"><span class="lineno">  162</span>                    <span class="keywordflow">if</span> (response != <span class="stringliteral">&quot;y&quot;</span> &amp;&amp; response != <span class="stringliteral">&quot;Y&quot;</span>) {</div>
<div class="line"><span class="lineno">  163</span>                        Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Template save cancelled&quot;</span>);</div>
<div class="line"><span class="lineno">  164</span>                        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  165</span>                    }</div>
<div class="line"><span class="lineno">  166</span>                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (validation_result.has_issues(TemplateValidationLevel::WARNING)) {</div>
<div class="line"><span class="lineno">  167</span>                    Logger::getInstance().log(LogLevel::NORMAL, <span class="stringliteral">&quot;Template has validation warnings:&quot;</span>);</div>
<div class="line"><span class="lineno">  168</span>                    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; issue : validation_result.get_issues(TemplateValidationLevel::WARNING)) {</div>
<div class="line"><span class="lineno">  169</span>                        std::cout &lt;&lt; <span class="stringliteral">&quot;  - &quot;</span> &lt;&lt; issue.to_string() &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  170</span>                    }</div>
<div class="line"><span class="lineno">  171</span>                }</div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>                template_manager.save_template(name, current_query);</div>
<div class="line"><span class="lineno">  174</span>                Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Query saved as template: &quot;</span>, name);</div>
<div class="line"><span class="lineno">  175</span>            } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno">  176</span>                Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;Failed to save template: &quot;</span>, e.what());</div>
<div class="line"><span class="lineno">  177</span>            }</div>
<div class="line"><span class="lineno">  178</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line.substr(0, 14) == <span class="stringliteral">&quot;template load &quot;</span>) {</div>
<div class="line"><span class="lineno">  179</span>            std::string name = line.substr(14);</div>
<div class="line"><span class="lineno">  180</span>            <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  181</span>                current_query = template_manager.load_template(name);</div>
<div class="line"><span class="lineno">  182</span>                Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Template loaded: &quot;</span>, name);</div>
<div class="line"><span class="lineno">  183</span>            } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno">  184</span>                Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;Failed to load template: &quot;</span>, e.what());</div>
<div class="line"><span class="lineno">  185</span>            }</div>
<div class="line"><span class="lineno">  186</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line.substr(0, 14) == <span class="stringliteral">&quot;template info &quot;</span>) {</div>
<div class="line"><span class="lineno">  187</span>            std::string name = line.substr(14);</div>
<div class="line"><span class="lineno">  188</span>            <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  189</span>                <span class="keyword">auto</span> metadata = template_manager.get_template_metadata(name);</div>
<div class="line"><span class="lineno">  190</span>                std::cout &lt;&lt; <span class="stringliteral">&quot;Template: &quot;</span> &lt;&lt; metadata.name &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  191</span>                std::cout &lt;&lt; <span class="stringliteral">&quot;Description: &quot;</span> &lt;&lt; metadata.description &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  192</span>                std::cout &lt;&lt; <span class="stringliteral">&quot;Last modified: &quot;</span> &lt;&lt; metadata.last_modified &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  193</span>                </div>
<div class="line"><span class="lineno">  194</span>                <span class="comment">// show parent template if it exists</span></div>
<div class="line"><span class="lineno">  195</span>                <span class="keywordflow">if</span> (metadata.parent.has_value() &amp;&amp; !metadata.parent.value().empty()) {</div>
<div class="line"><span class="lineno">  196</span>                    std::cout &lt;&lt; <span class="stringliteral">&quot;Inherits from: &quot;</span> &lt;&lt; metadata.parent.value() &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  197</span>                }</div>
<div class="line"><span class="lineno">  198</span>                </div>
<div class="line"><span class="lineno">  199</span>                <span class="keywordflow">if</span> (!metadata.variables.empty()) {</div>
<div class="line"><span class="lineno">  200</span>                    std::cout &lt;&lt; <span class="stringliteral">&quot;Variables:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  201</span>                    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; var : metadata.variables) {</div>
<div class="line"><span class="lineno">  202</span>                        std::cout &lt;&lt; <span class="stringliteral">&quot;  ${&quot;</span> &lt;&lt; var &lt;&lt; <span class="stringliteral">&quot;}&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  203</span>                    }</div>
<div class="line"><span class="lineno">  204</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  205</span>                    std::cout &lt;&lt; <span class="stringliteral">&quot;No variables found&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  206</span>                }</div>
<div class="line"><span class="lineno">  207</span>            } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno">  208</span>                Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;Failed to get template info: &quot;</span>, e.what());</div>
<div class="line"><span class="lineno">  209</span>            }</div>
<div class="line"><span class="lineno">  210</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line.substr(0, 16) == <span class="stringliteral">&quot;template delete &quot;</span>) {</div>
<div class="line"><span class="lineno">  211</span>            std::string name = line.substr(16);</div>
<div class="line"><span class="lineno">  212</span>            <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  213</span>                <span class="keywordflow">if</span> (template_manager.delete_template(name)) {</div>
<div class="line"><span class="lineno">  214</span>                    Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Template deleted: &quot;</span>, name);</div>
<div class="line"><span class="lineno">  215</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  216</span>                    Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;Failed to delete template: &quot;</span>, name);</div>
<div class="line"><span class="lineno">  217</span>                }</div>
<div class="line"><span class="lineno">  218</span>            } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno">  219</span>                Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;Error deleting template: &quot;</span>, e.what());</div>
<div class="line"><span class="lineno">  220</span>            }</div>
<div class="line"><span class="lineno">  221</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line.substr(0, 16) == <span class="stringliteral">&quot;template setvar &quot;</span>) {</div>
<div class="line"><span class="lineno">  222</span>            std::string var_def = line.substr(16);</div>
<div class="line"><span class="lineno">  223</span>            <span class="keywordtype">size_t</span> equals_pos = var_def.find(<span class="charliteral">&#39;=&#39;</span>);</div>
<div class="line"><span class="lineno">  224</span>            </div>
<div class="line"><span class="lineno">  225</span>            <span class="keywordflow">if</span> (equals_pos == std::string::npos) {</div>
<div class="line"><span class="lineno">  226</span>                Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;Invalid variable format. Use NAME=VALUE&quot;</span>);</div>
<div class="line"><span class="lineno">  227</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  228</span>            }</div>
<div class="line"><span class="lineno">  229</span>            </div>
<div class="line"><span class="lineno">  230</span>            std::string name = var_def.substr(0, equals_pos);</div>
<div class="line"><span class="lineno">  231</span>            std::string value = var_def.substr(equals_pos + 1);</div>
<div class="line"><span class="lineno">  232</span>            </div>
<div class="line"><span class="lineno">  233</span>            <span class="comment">// add/update the variable in both current query- and memory -</span></div>
<div class="line"><span class="lineno">  234</span>            <span class="comment">// first update in memory for future template usage</span></div>
<div class="line"><span class="lineno">  235</span>            current_variables[name] = value;</div>
<div class="line"><span class="lineno">  236</span>            </div>
<div class="line"><span class="lineno">  237</span>            <span class="comment">// then update in the current query if it exists</span></div>
<div class="line"><span class="lineno">  238</span>            std::stringstream new_query;</div>
<div class="line"><span class="lineno">  239</span>            <span class="keywordtype">bool</span> variable_updated = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  240</span>            </div>
<div class="line"><span class="lineno">  241</span>            <span class="comment">// if the query is empty, add the variable</span></div>
<div class="line"><span class="lineno">  242</span>            <span class="keywordflow">if</span> (current_query.empty()) {</div>
<div class="line"><span class="lineno">  243</span>                new_query &lt;&lt; <span class="stringliteral">&quot;@variable \&quot;&quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;\&quot; \&quot;&quot;</span> &lt;&lt; value &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span>;</div>
<div class="line"><span class="lineno">  244</span>                current_query = new_query.str();</div>
<div class="line"><span class="lineno">  245</span>                variable_updated = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  246</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  247</span>                <span class="comment">// check if a variable already exists in the query</span></div>
<div class="line"><span class="lineno">  248</span>                std::istringstream iss(current_query);</div>
<div class="line"><span class="lineno">  249</span>                std::string get_line;</div>
<div class="line"><span class="lineno">  250</span>                std::regex var_regex(<span class="stringliteral">&quot;@variable\\s+\&quot;&quot;</span> + name + <span class="stringliteral">&quot;\&quot;\\s+\&quot;([^\&quot;]*)\&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  251</span> </div>
<div class="line"><span class="lineno">  252</span>                <span class="keywordflow">while</span> (std::getline(iss, get_line)) {</div>
<div class="line"><span class="lineno">  253</span>                    std::smatch match;</div>
<div class="line"><span class="lineno">  254</span>                    <span class="keywordflow">if</span> (std::regex_match(get_line, match, var_regex)) {</div>
<div class="line"><span class="lineno">  255</span>                        <span class="comment">// update the existing variable</span></div>
<div class="line"><span class="lineno">  256</span>                        new_query &lt;&lt; <span class="stringliteral">&quot;@variable \&quot;&quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;\&quot; \&quot;&quot;</span> &lt;&lt; value &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span>;</div>
<div class="line"><span class="lineno">  257</span>                        variable_updated = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  258</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  259</span>                        new_query &lt;&lt; get_line;</div>
<div class="line"><span class="lineno">  260</span>                    }</div>
<div class="line"><span class="lineno">  261</span>                    new_query &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  262</span>                }</div>
<div class="line"><span class="lineno">  263</span>                </div>
<div class="line"><span class="lineno">  264</span>                <span class="comment">// if the variable wasn&#39;t found, add it at the beginning</span></div>
<div class="line"><span class="lineno">  265</span>                <span class="keywordflow">if</span> (!variable_updated) {</div>
<div class="line"><span class="lineno">  266</span>                    std::string var_declaration = <span class="stringliteral">&quot;@variable \&quot;&quot;</span>;</div>
<div class="line"><span class="lineno">  267</span>                    var_declaration.append(name);</div>
<div class="line"><span class="lineno">  268</span>                    var_declaration.append(<span class="stringliteral">&quot;\&quot; \&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  269</span>                    var_declaration.append(value);</div>
<div class="line"><span class="lineno">  270</span>                    var_declaration.append(<span class="stringliteral">&quot;\&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">  271</span>                    current_query.append(var_declaration);</div>
<div class="line"><span class="lineno">  272</span>                    current_query.append(current_query);</div>
<div class="line"><span class="lineno">  273</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  274</span>                    current_query = new_query.str();</div>
<div class="line"><span class="lineno">  275</span>                }</div>
<div class="line"><span class="lineno">  276</span>            }</div>
<div class="line"><span class="lineno">  277</span>            </div>
<div class="line"><span class="lineno">  278</span>            <span class="keywordflow">if</span> (variable_updated) {</div>
<div class="line"><span class="lineno">  279</span>                Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Variable updated: &quot;</span>, name, <span class="stringliteral">&quot;=&quot;</span>, value);</div>
<div class="line"><span class="lineno">  280</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  281</span>                Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Variable added: &quot;</span>, name, <span class="stringliteral">&quot;=&quot;</span>, value);</div>
<div class="line"><span class="lineno">  282</span>            }</div>
<div class="line"><span class="lineno">  283</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line.substr(0, 13) == <span class="stringliteral">&quot;template use &quot;</span>) {</div>
<div class="line"><span class="lineno">  284</span>            std::string name = line.substr(13);</div>
<div class="line"><span class="lineno">  285</span>            <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  286</span>                <span class="comment">// first validate the template</span></div>
<div class="line"><span class="lineno">  287</span>                <span class="keyword">auto</span> validation_result = template_validator.validate_template(name);</div>
<div class="line"><span class="lineno">  288</span>                </div>
<div class="line"><span class="lineno">  289</span>                <span class="comment">// check for critical errors</span></div>
<div class="line"><span class="lineno">  290</span>                <span class="keywordflow">if</span> (validation_result.has_issues(TemplateValidationLevel::ERROR)) {</div>
<div class="line"><span class="lineno">  291</span>                    Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;Template validation failed with errors:&quot;</span>);</div>
<div class="line"><span class="lineno">  292</span>                    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; issue : validation_result.get_issues(TemplateValidationLevel::ERROR)) {</div>
<div class="line"><span class="lineno">  293</span>                        std::cout &lt;&lt; <span class="stringliteral">&quot;  - &quot;</span> &lt;&lt; issue.to_string() &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  294</span>                    }</div>
<div class="line"><span class="lineno">  295</span>                    </div>
<div class="line"><span class="lineno">  296</span>                    std::cout &lt;&lt; <span class="stringliteral">&quot;Do you want to use this template anyway? (y/n): &quot;</span>;</div>
<div class="line"><span class="lineno">  297</span>                    std::string response;</div>
<div class="line"><span class="lineno">  298</span>                    std::getline(std::cin, response);</div>
<div class="line"><span class="lineno">  299</span>                    </div>
<div class="line"><span class="lineno">  300</span>                    <span class="keywordflow">if</span> (response != <span class="stringliteral">&quot;y&quot;</span> &amp;&amp; response != <span class="stringliteral">&quot;Y&quot;</span>) {</div>
<div class="line"><span class="lineno">  301</span>                        Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Template use cancelled&quot;</span>);</div>
<div class="line"><span class="lineno">  302</span>                        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  303</span>                    }</div>
<div class="line"><span class="lineno">  304</span>                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (validation_result.has_issues(TemplateValidationLevel::WARNING)) {</div>
<div class="line"><span class="lineno">  305</span>                    Logger::getInstance().log(LogLevel::NORMAL, <span class="stringliteral">&quot;Template has validation warnings:&quot;</span>);</div>
<div class="line"><span class="lineno">  306</span>                    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; issue : validation_result.get_issues(TemplateValidationLevel::WARNING)) {</div>
<div class="line"><span class="lineno">  307</span>                        std::cout &lt;&lt; <span class="stringliteral">&quot;  - &quot;</span> &lt;&lt; issue.to_string() &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  308</span>                    }</div>
<div class="line"><span class="lineno">  309</span>                }</div>
<div class="line"><span class="lineno">  310</span> </div>
<div class="line"><span class="lineno">  311</span>                <span class="comment">// extract variables from the current query</span></div>
<div class="line"><span class="lineno">  312</span>                std::map&lt;std::string, std::string&gt; variables;</div>
<div class="line"><span class="lineno">  313</span>                std::istringstream iss(current_query);</div>
<div class="line"><span class="lineno">  314</span>                std::string curr_line;</div>
<div class="line"><span class="lineno">  315</span>                std::regex var_regex(<span class="stringliteral">&quot;@variable\\s+\&quot;([^\&quot;]*)\&quot;\\s+\&quot;([^\&quot;]*)\&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  316</span>                </div>
<div class="line"><span class="lineno">  317</span>                <span class="keywordflow">while</span> (std::getline(iss, curr_line)) {</div>
<div class="line"><span class="lineno">  318</span>                    std::smatch match;</div>
<div class="line"><span class="lineno">  319</span>                    <span class="keywordflow">if</span> (std::regex_match(curr_line, match, var_regex) &amp;&amp; match.size() &gt; 2) {</div>
<div class="line"><span class="lineno">  320</span>                        variables[match[1].str()] = match[2].str();</div>
<div class="line"><span class="lineno">  321</span>                    }</div>
<div class="line"><span class="lineno">  322</span>                }</div>
<div class="line"><span class="lineno">  323</span>                </div>
<div class="line"><span class="lineno">  324</span>                <span class="comment">// combine current variables with template variables will override memory variables</span></div>
<div class="line"><span class="lineno">  325</span>                <span class="comment">// if there are duplicates</span></div>
<div class="line"><span class="lineno">  326</span>                std::map&lt;std::string, std::string&gt; combined_variables = current_variables;</div>
<div class="line"><span class="lineno">  327</span>                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [name, value] : variables) {</div>
<div class="line"><span class="lineno">  328</span>                    combined_variables[name] = value;</div>
<div class="line"><span class="lineno">  329</span>                }</div>
<div class="line"><span class="lineno">  330</span>                </div>
<div class="line"><span class="lineno">  331</span>                <span class="comment">// check for missing variables</span></div>
<div class="line"><span class="lineno">  332</span>                std::string template_content = template_manager.load_template(name);</div>
<div class="line"><span class="lineno">  333</span>                <span class="keyword">auto</span> template_vars = template_manager.collect_variables(template_content);</div>
<div class="line"><span class="lineno">  334</span>                </div>
<div class="line"><span class="lineno">  335</span>                <span class="comment">// get all variables used in the template from a validation result</span></div>
<div class="line"><span class="lineno">  336</span>                <span class="keyword">auto</span> referenced_vars = validation_result.get_issues(TemplateValidationLevel::INFO);</div>
<div class="line"><span class="lineno">  337</span>                std::vector&lt;std::string&gt; missing_vars;</div>
<div class="line"><span class="lineno">  338</span>                </div>
<div class="line"><span class="lineno">  339</span>                <span class="comment">// check for variables that are referenced but not declared</span></div>
<div class="line"><span class="lineno">  340</span>                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; issue : referenced_vars) {</div>
<div class="line"><span class="lineno">  341</span>                    <span class="comment">// if the issue is about a variable, check if it&#39;s available</span></div>
<div class="line"><span class="lineno">  342</span>                    <span class="keywordflow">if</span> (issue.get_variable_name().has_value()) {</div>
<div class="line"><span class="lineno">  343</span>                        std::string var_name = issue.get_variable_name().value();</div>
<div class="line"><span class="lineno">  344</span>                        <span class="keywordflow">if</span> (!combined_variables.contains(var_name) &amp;&amp;</div>
<div class="line"><span class="lineno">  345</span>                            !template_vars.contains(var_name)) {</div>
<div class="line"><span class="lineno">  346</span>                            missing_vars.push_back(var_name);</div>
<div class="line"><span class="lineno">  347</span>                        }</div>
<div class="line"><span class="lineno">  348</span>                    }</div>
<div class="line"><span class="lineno">  349</span>                }</div>
<div class="line"><span class="lineno">  350</span>                </div>
<div class="line"><span class="lineno">  351</span>                <span class="comment">// if there are missing variables, prompt the user to enter them</span></div>
<div class="line"><span class="lineno">  352</span>                <span class="keywordflow">if</span> (!missing_vars.empty()) {</div>
<div class="line"><span class="lineno">  353</span>                    Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Template is missing values for these variables:&quot;</span>);</div>
<div class="line"><span class="lineno">  354</span>                    </div>
<div class="line"><span class="lineno">  355</span>                    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; var : missing_vars) {</div>
<div class="line"><span class="lineno">  356</span>                        std::cout &lt;&lt; <span class="stringliteral">&quot;  Enter value for &#39;&quot;</span> &lt;&lt; var &lt;&lt; <span class="stringliteral">&quot;&#39;: &quot;</span>;</div>
<div class="line"><span class="lineno">  357</span>                        std::string value;</div>
<div class="line"><span class="lineno">  358</span>                        std::getline(std::cin, value);</div>
<div class="line"><span class="lineno">  359</span>                        combined_variables[var] = value;</div>
<div class="line"><span class="lineno">  360</span>                    }</div>
<div class="line"><span class="lineno">  361</span>                }</div>
<div class="line"><span class="lineno">  362</span>                </div>
<div class="line"><span class="lineno">  363</span>                <span class="comment">// instantiate the template with the variables</span></div>
<div class="line"><span class="lineno">  364</span>                current_query = template_manager.instantiate_template(name, combined_variables);</div>
<div class="line"><span class="lineno">  365</span>                Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Template instantiated: &quot;</span>, name);</div>
<div class="line"><span class="lineno">  366</span>            } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno">  367</span>                Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;Failed to use template: &quot;</span>, e.what());</div>
<div class="line"><span class="lineno">  368</span>            }</div>
<div class="line"><span class="lineno">  369</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line == <span class="stringliteral">&quot;template dir&quot;</span>) {</div>
<div class="line"><span class="lineno">  370</span>            <span class="comment">// show the current templates directory</span></div>
<div class="line"><span class="lineno">  371</span>            std::cout &lt;&lt; <span class="stringliteral">&quot;Templates directory: &quot;</span> </div>
<div class="line"><span class="lineno">  372</span>                     &lt;&lt; template_manager.get_templates_directory() &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  373</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line.substr(0, 13) == <span class="stringliteral">&quot;template dir &quot;</span>) {</div>
<div class="line"><span class="lineno">  374</span>            <span class="comment">// set the templates directory</span></div>
<div class="line"><span class="lineno">  375</span>            std::string dir = line.substr(13);</div>
<div class="line"><span class="lineno">  376</span>            <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  377</span>                template_manager.set_templates_directory(dir);</div>
<div class="line"><span class="lineno">  378</span>                Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Templates directory set to: &quot;</span>, dir);</div>
<div class="line"><span class="lineno">  379</span>            } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno">  380</span>                Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;Failed to set templates directory: &quot;</span>, e.what());</div>
<div class="line"><span class="lineno">  381</span>            }</div>
<div class="line"><span class="lineno">  382</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line == <span class="stringliteral">&quot;categories&quot;</span>) {</div>
<div class="line"><span class="lineno">  383</span>            <span class="comment">// list categories</span></div>
<div class="line"><span class="lineno">  384</span>            <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  385</span>                <span class="keyword">auto</span> categories = template_manager.list_categories();</div>
<div class="line"><span class="lineno">  386</span>                <span class="keywordflow">if</span> (categories.empty()) {</div>
<div class="line"><span class="lineno">  387</span>                    Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;No categories found&quot;</span>);</div>
<div class="line"><span class="lineno">  388</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  389</span>                    Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Available categories:&quot;</span>);</div>
<div class="line"><span class="lineno">  390</span>                    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; category : categories) {</div>
<div class="line"><span class="lineno">  391</span>                        std::cout &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; category &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  392</span>                    }</div>
<div class="line"><span class="lineno">  393</span>                }</div>
<div class="line"><span class="lineno">  394</span>            } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno">  395</span>                Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;Error listing categories: &quot;</span>, e.what());</div>
<div class="line"><span class="lineno">  396</span>            }</div>
<div class="line"><span class="lineno">  397</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line.substr(0, 16) == <span class="stringliteral">&quot;category create &quot;</span>) {</div>
<div class="line"><span class="lineno">  398</span>            <span class="comment">// create a new category</span></div>
<div class="line"><span class="lineno">  399</span>            std::string category = line.substr(16);</div>
<div class="line"><span class="lineno">  400</span>            <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  401</span>                <span class="keywordflow">if</span> (template_manager.create_category(category)) {</div>
<div class="line"><span class="lineno">  402</span>                    Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Category created: &quot;</span>, category);</div>
<div class="line"><span class="lineno">  403</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  404</span>                    Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;Failed to create category: &quot;</span>, category);</div>
<div class="line"><span class="lineno">  405</span>                }</div>
<div class="line"><span class="lineno">  406</span>            } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno">  407</span>                Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;Error creating category: &quot;</span>, e.what());</div>
<div class="line"><span class="lineno">  408</span>            }</div>
<div class="line"><span class="lineno">  409</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line == <span class="stringliteral">&quot;template vars&quot;</span>) {</div>
<div class="line"><span class="lineno">  410</span>            <span class="comment">// show current variables in memory</span></div>
<div class="line"><span class="lineno">  411</span>            <span class="keywordflow">if</span> (current_variables.empty()) {</div>
<div class="line"><span class="lineno">  412</span>                Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;No variables currently defined&quot;</span>);</div>
<div class="line"><span class="lineno">  413</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  414</span>                Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Current variables:&quot;</span>);</div>
<div class="line"><span class="lineno">  415</span>                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [name, value] : current_variables) {</div>
<div class="line"><span class="lineno">  416</span>                    std::cout &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; = \&quot;&quot;</span> &lt;&lt; value &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  417</span>                }</div>
<div class="line"><span class="lineno">  418</span>            }</div>
<div class="line"><span class="lineno">  419</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line == <span class="stringliteral">&quot;template clearvars&quot;</span>) {</div>
<div class="line"><span class="lineno">  420</span>            <span class="comment">// clear all current variables</span></div>
<div class="line"><span class="lineno">  421</span>            current_variables.clear();</div>
<div class="line"><span class="lineno">  422</span>            Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;All variables cleared&quot;</span>);</div>
<div class="line"><span class="lineno">  423</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line.substr(0, 14) == <span class="stringliteral">&quot;template vars &quot;</span>) {</div>
<div class="line"><span class="lineno">  424</span>            <span class="comment">// list variables in a specific template</span></div>
<div class="line"><span class="lineno">  425</span>            std::string template_name = line.substr(14);</div>
<div class="line"><span class="lineno">  426</span>            <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  427</span>                <span class="keyword">auto</span> metadata = template_manager.get_template_metadata(template_name);</div>
<div class="line"><span class="lineno">  428</span>                </div>
<div class="line"><span class="lineno">  429</span>                <span class="keywordflow">if</span> (metadata.variables.empty()) {</div>
<div class="line"><span class="lineno">  430</span>                    Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;No variables found in template: &quot;</span>, template_name);</div>
<div class="line"><span class="lineno">  431</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  432</span>                    Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Variables in template: &quot;</span>, template_name);</div>
<div class="line"><span class="lineno">  433</span>                    </div>
<div class="line"><span class="lineno">  434</span>                    <span class="comment">// get template content to extract default values if available</span></div>
<div class="line"><span class="lineno">  435</span>                    std::string content = template_manager.load_template(template_name);</div>
<div class="line"><span class="lineno">  436</span>                    <span class="keyword">auto</span> variables_with_values = template_manager.collect_variables(content);</div>
<div class="line"><span class="lineno">  437</span>                    </div>
<div class="line"><span class="lineno">  438</span>                    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; var_name : metadata.variables) {</div>
<div class="line"><span class="lineno">  439</span>                        std::string default_value;</div>
<div class="line"><span class="lineno">  440</span>                        <span class="keywordflow">if</span> (variables_with_values.contains(var_name))</div>
<div class="line"><span class="lineno">  441</span>                            default_value = variables_with_values[var_name];</div>
<div class="line"><span class="lineno">  442</span>                        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  443</span>                            default_value = <span class="stringliteral">&quot;(no default)&quot;</span>;</div>
<div class="line"><span class="lineno">  444</span>                        std::cout &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; var_name &lt;&lt; <span class="stringliteral">&quot; = \&quot;&quot;</span> &lt;&lt; default_value &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  445</span>                    }</div>
<div class="line"><span class="lineno">  446</span>                }</div>
<div class="line"><span class="lineno">  447</span>            } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno">  448</span>                Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;Error listing template variables: &quot;</span>, e.what());</div>
<div class="line"><span class="lineno">  449</span>            }</div>
<div class="line"><span class="lineno">  450</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line == <span class="stringliteral">&quot;template setvars&quot;</span>) {</div>
<div class="line"><span class="lineno">  451</span>            <span class="comment">// interactive mode for setting multiple variables</span></div>
<div class="line"><span class="lineno">  452</span>            Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Enter variables in NAME=VALUE format (empty line to finish):&quot;</span>);</div>
<div class="line"><span class="lineno">  453</span>            </div>
<div class="line"><span class="lineno">  454</span>            <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno">  455</span>                std::string var_line;</div>
<div class="line"><span class="lineno">  456</span>                std::cout &lt;&lt; <span class="stringliteral">&quot;var&gt; &quot;</span>;</div>
<div class="line"><span class="lineno">  457</span>                std::getline(std::cin, var_line);</div>
<div class="line"><span class="lineno">  458</span>                </div>
<div class="line"><span class="lineno">  459</span>                <span class="keywordflow">if</span> (var_line.empty()) {</div>
<div class="line"><span class="lineno">  460</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  461</span>                }</div>
<div class="line"><span class="lineno">  462</span>                </div>
<div class="line"><span class="lineno">  463</span>                <span class="keywordtype">size_t</span> equals_pos = var_line.find(<span class="charliteral">&#39;=&#39;</span>);</div>
<div class="line"><span class="lineno">  464</span>                <span class="keywordflow">if</span> (equals_pos == std::string::npos) {</div>
<div class="line"><span class="lineno">  465</span>                    Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;Invalid format. Use NAME=VALUE&quot;</span>);</div>
<div class="line"><span class="lineno">  466</span>                    <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  467</span>                }</div>
<div class="line"><span class="lineno">  468</span>                </div>
<div class="line"><span class="lineno">  469</span>                std::string name = var_line.substr(0, equals_pos);</div>
<div class="line"><span class="lineno">  470</span>                std::string value = var_line.substr(equals_pos + 1);</div>
<div class="line"><span class="lineno">  471</span>                </div>
<div class="line"><span class="lineno">  472</span>                <span class="comment">// add to current variables</span></div>
<div class="line"><span class="lineno">  473</span>                current_variables[name] = value;</div>
<div class="line"><span class="lineno">  474</span>                Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Variable set: &quot;</span>, name, <span class="stringliteral">&quot;=&quot;</span>, value);</div>
<div class="line"><span class="lineno">  475</span>            }</div>
<div class="line"><span class="lineno">  476</span>            </div>
<div class="line"><span class="lineno">  477</span>            Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Finished setting variables&quot;</span>);</div>
<div class="line"><span class="lineno">  478</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line.substr(0, 17) == <span class="stringliteral">&quot;template inherit &quot;</span>) {</div>
<div class="line"><span class="lineno">  479</span>            <span class="comment">// create a template that inherits from another template</span></div>
<div class="line"><span class="lineno">  480</span>            std::string params = line.substr(17);</div>
<div class="line"><span class="lineno">  481</span>            <span class="keywordtype">size_t</span> space_pos = params.find(<span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"><span class="lineno">  482</span>            <span class="keywordflow">if</span> (space_pos == std::string::npos) {</div>
<div class="line"><span class="lineno">  483</span>                Logger::getInstance().log(LogLevel::ERROR, </div>
<div class="line"><span class="lineno">  484</span>                    <span class="stringliteral">&quot;Invalid format. Use: template inherit CHILD_NAME PARENT_NAME&quot;</span>);</div>
<div class="line"><span class="lineno">  485</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  486</span>            }</div>
<div class="line"><span class="lineno">  487</span>            </div>
<div class="line"><span class="lineno">  488</span>            std::string child_name = params.substr(0, space_pos);</div>
<div class="line"><span class="lineno">  489</span>            std::string parent_name = params.substr(space_pos + 1);</div>
<div class="line"><span class="lineno">  490</span>            </div>
<div class="line"><span class="lineno">  491</span>            <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  492</span>                <span class="keywordflow">if</span> (current_query.empty()) {</div>
<div class="line"><span class="lineno">  493</span>                    Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;Cannot create inherited template with empty content&quot;</span>);</div>
<div class="line"><span class="lineno">  494</span>                    <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  495</span>                }</div>
<div class="line"><span class="lineno">  496</span>                </div>
<div class="line"><span class="lineno">  497</span>                <span class="comment">// add inherit directive if not already present</span></div>
<div class="line"><span class="lineno">  498</span>                <span class="keywordflow">if</span> (std::regex inherit_regex(<span class="stringliteral">&quot;@inherit\\s+\&quot;([^\&quot;]*)\&quot;&quot;</span>); !std::regex_search(current_query, inherit_regex)) {</div>
<div class="line"><span class="lineno">  499</span>                    <span class="comment">// add @inherit directive at the beginning of the content</span></div>
<div class="line"><span class="lineno">  500</span>                    <span class="keyword">const</span> std::string saved_query = current_query;</div>
<div class="line"><span class="lineno">  501</span>                    current_query.append(parent_name);</div>
<div class="line"><span class="lineno">  502</span>                    current_query.append(<span class="stringliteral">&quot;\&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">  503</span>                    current_query.append(saved_query);</div>
<div class="line"><span class="lineno">  504</span>                }</div>
<div class="line"><span class="lineno">  505</span>                </div>
<div class="line"><span class="lineno">  506</span>                <span class="comment">// validate the template before saving</span></div>
<div class="line"><span class="lineno">  507</span>                <span class="keyword">auto</span> validation_result = template_validator.validate_content(current_query);</div>
<div class="line"><span class="lineno">  508</span>                </div>
<div class="line"><span class="lineno">  509</span>                <span class="comment">// check for inheritance errors</span></div>
<div class="line"><span class="lineno">  510</span>                <span class="keywordtype">bool</span> has_inheritance_error = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  511</span>                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; issue : validation_result.get_issues(TemplateValidationLevel::ERROR)) {</div>
<div class="line"><span class="lineno">  512</span>                    <span class="keywordflow">if</span> (issue.to_string().find(<span class="stringliteral">&quot;inherit&quot;</span>) != std::string::npos || </div>
<div class="line"><span class="lineno">  513</span>                        issue.to_string().find(<span class="stringliteral">&quot;circular&quot;</span>) != std::string::npos) {</div>
<div class="line"><span class="lineno">  514</span>                        has_inheritance_error = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  515</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  516</span>                    }</div>
<div class="line"><span class="lineno">  517</span>                }</div>
<div class="line"><span class="lineno">  518</span>                </div>
<div class="line"><span class="lineno">  519</span>                <span class="comment">// if there are inheritance errors, don&#39;t allow override</span></div>
<div class="line"><span class="lineno">  520</span>                <span class="keywordflow">if</span> (has_inheritance_error) {</div>
<div class="line"><span class="lineno">  521</span>                    Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;Template inheritance validation failed:&quot;</span>);</div>
<div class="line"><span class="lineno">  522</span>                    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; issue : validation_result.get_issues(TemplateValidationLevel::ERROR)) {</div>
<div class="line"><span class="lineno">  523</span>                        <span class="keywordflow">if</span> (issue.to_string().find(<span class="stringliteral">&quot;inherit&quot;</span>) != std::string::npos || </div>
<div class="line"><span class="lineno">  524</span>                            issue.to_string().find(<span class="stringliteral">&quot;circular&quot;</span>) != std::string::npos) {</div>
<div class="line"><span class="lineno">  525</span>                            std::cout &lt;&lt; <span class="stringliteral">&quot;  - &quot;</span> &lt;&lt; issue.to_string() &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  526</span>                        }</div>
<div class="line"><span class="lineno">  527</span>                    }</div>
<div class="line"><span class="lineno">  528</span>                    <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  529</span>                }</div>
<div class="line"><span class="lineno">  530</span>                </div>
<div class="line"><span class="lineno">  531</span>                <span class="comment">// for other validation errors, prompt for confirmation</span></div>
<div class="line"><span class="lineno">  532</span>                <span class="keywordflow">if</span> (validation_result.has_issues(TemplateValidationLevel::ERROR)) {</div>
<div class="line"><span class="lineno">  533</span>                    Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;Template validation failed with errors:&quot;</span>);</div>
<div class="line"><span class="lineno">  534</span>                    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; issue : validation_result.get_issues(TemplateValidationLevel::ERROR)) {</div>
<div class="line"><span class="lineno">  535</span>                        std::cout &lt;&lt; <span class="stringliteral">&quot;  - &quot;</span> &lt;&lt; issue.to_string() &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  536</span>                    }</div>
<div class="line"><span class="lineno">  537</span>                    </div>
<div class="line"><span class="lineno">  538</span>                    std::cout &lt;&lt; <span class="stringliteral">&quot;Do you want to save the template anyway? (y/n): &quot;</span>;</div>
<div class="line"><span class="lineno">  539</span>                    std::string response;</div>
<div class="line"><span class="lineno">  540</span>                    std::getline(std::cin, response);</div>
<div class="line"><span class="lineno">  541</span>                    </div>
<div class="line"><span class="lineno">  542</span>                    <span class="keywordflow">if</span> (response != <span class="stringliteral">&quot;y&quot;</span> &amp;&amp; response != <span class="stringliteral">&quot;Y&quot;</span>) {</div>
<div class="line"><span class="lineno">  543</span>                        Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Template save cancelled&quot;</span>);</div>
<div class="line"><span class="lineno">  544</span>                        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  545</span>                    }</div>
<div class="line"><span class="lineno">  546</span>                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (validation_result.has_issues(TemplateValidationLevel::WARNING)) {</div>
<div class="line"><span class="lineno">  547</span>                    Logger::getInstance().log(LogLevel::NORMAL, <span class="stringliteral">&quot;Template has validation warnings:&quot;</span>);</div>
<div class="line"><span class="lineno">  548</span>                    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; issue : validation_result.get_issues(TemplateValidationLevel::WARNING)) {</div>
<div class="line"><span class="lineno">  549</span>                        std::cout &lt;&lt; <span class="stringliteral">&quot;  - &quot;</span> &lt;&lt; issue.to_string() &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  550</span>                    }</div>
<div class="line"><span class="lineno">  551</span>                }</div>
<div class="line"><span class="lineno">  552</span>                </div>
<div class="line"><span class="lineno">  553</span>                template_manager.create_inherited_template(child_name, parent_name, current_query);</div>
<div class="line"><span class="lineno">  554</span>                Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Created template &#39;&quot;</span>, child_name, </div>
<div class="line"><span class="lineno">  555</span>                                         <span class="stringliteral">&quot;&#39; inheriting from &#39;&quot;</span>, parent_name, <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><span class="lineno">  556</span>            } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno">  557</span>                Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;Failed to create inherited template: &quot;</span>, e.what());</div>
<div class="line"><span class="lineno">  558</span>            }</div>
<div class="line"><span class="lineno">  559</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line.substr(0, 17) == <span class="stringliteral">&quot;template parents &quot;</span>) {</div>
<div class="line"><span class="lineno">  560</span>            <span class="comment">// show an inheritance chain for a template</span></div>
<div class="line"><span class="lineno">  561</span>            std::string template_name = line.substr(17);</div>
<div class="line"><span class="lineno">  562</span>            <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  563</span>                <span class="keyword">auto</span> chain = template_manager.get_inheritance_chain(template_name);</div>
<div class="line"><span class="lineno">  564</span>                </div>
<div class="line"><span class="lineno">  565</span>                <span class="keywordflow">if</span> (chain.size() &lt;= 1) {</div>
<div class="line"><span class="lineno">  566</span>                    Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Template &#39;&quot;</span>, template_name, </div>
<div class="line"><span class="lineno">  567</span>                                             <span class="stringliteral">&quot;&#39; does not inherit from any other template&quot;</span>);</div>
<div class="line"><span class="lineno">  568</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  569</span>                    Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Inheritance chain for &#39;&quot;</span>, template_name, <span class="stringliteral">&quot;&#39;:&quot;</span>);</div>
<div class="line"><span class="lineno">  570</span>                    </div>
<div class="line"><span class="lineno">  571</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; chain.size(); ++i) {</div>
<div class="line"><span class="lineno">  572</span>                        <span class="comment">// the first template is the base, the last is the current template</span></div>
<div class="line"><span class="lineno">  573</span>                        <span class="keywordflow">if</span> (i == 0) {</div>
<div class="line"><span class="lineno">  574</span>                            std::cout &lt;&lt; <span class="stringliteral">&quot;  Base: &quot;</span> &lt;&lt; chain[i] &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  575</span>                        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i == chain.size() - 1) {</div>
<div class="line"><span class="lineno">  576</span>                            std::cout &lt;&lt; <span class="stringliteral">&quot;  Current: &quot;</span> &lt;&lt; chain[i] &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  577</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  578</span>                            std::cout &lt;&lt; <span class="stringliteral">&quot;  Parent &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; chain[i] &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  579</span>                        }</div>
<div class="line"><span class="lineno">  580</span>                    }</div>
<div class="line"><span class="lineno">  581</span>                }</div>
<div class="line"><span class="lineno">  582</span>            } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno">  583</span>                Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;Error getting inheritance chain: &quot;</span>, e.what());</div>
<div class="line"><span class="lineno">  584</span>            }</div>
<div class="line"><span class="lineno">  585</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line.substr(0, 18) == <span class="stringliteral">&quot;template validate &quot;</span>) {</div>
<div class="line"><span class="lineno">  586</span>            <span class="comment">// validate a specific template</span></div>
<div class="line"><span class="lineno">  587</span>            std::string template_name = line.substr(18);</div>
<div class="line"><span class="lineno">  588</span>            <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  589</span>                <span class="keyword">auto</span> result = template_validator.validate_template(template_name);</div>
<div class="line"><span class="lineno">  590</span>                </div>
<div class="line"><span class="lineno">  591</span>                <span class="comment">// output validation results</span></div>
<div class="line"><span class="lineno">  592</span>                std::cout &lt;&lt; <span class="stringliteral">&quot;Validation results for template &#39;&quot;</span> &lt;&lt; template_name &lt;&lt; <span class="stringliteral">&quot;&#39;:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  593</span>                std::cout &lt;&lt; <span class="stringliteral">&quot;------------------------------------------&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  594</span>                </div>
<div class="line"><span class="lineno">  595</span>                <span class="keywordflow">if</span> (result.has_issues()) {</div>
<div class="line"><span class="lineno">  596</span>                    std::cout &lt;&lt; <span class="stringliteral">&quot;Found &quot;</span> &lt;&lt; result.count_errors() &lt;&lt; <span class="stringliteral">&quot; errors, &quot;</span></div>
<div class="line"><span class="lineno">  597</span>                              &lt;&lt; result.count_warnings() &lt;&lt; <span class="stringliteral">&quot; warnings, &quot;</span></div>
<div class="line"><span class="lineno">  598</span>                              &lt;&lt; result.count_infos() &lt;&lt; <span class="stringliteral">&quot; info messages.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  599</span>                    </div>
<div class="line"><span class="lineno">  600</span>                    <span class="comment">// print errors</span></div>
<div class="line"><span class="lineno">  601</span>                    <span class="keywordflow">if</span> (result.count_errors() &gt; 0) {</div>
<div class="line"><span class="lineno">  602</span>                        std::cout &lt;&lt; <span class="stringliteral">&quot;\nErrors:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  603</span>                        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; issue : result.get_issues(TemplateValidationLevel::ERROR)) {</div>
<div class="line"><span class="lineno">  604</span>                            std::cout &lt;&lt; <span class="stringliteral">&quot;  - &quot;</span> &lt;&lt; issue.to_string() &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  605</span>                        }</div>
<div class="line"><span class="lineno">  606</span>                    }</div>
<div class="line"><span class="lineno">  607</span>                    </div>
<div class="line"><span class="lineno">  608</span>                    <span class="comment">// print warnings</span></div>
<div class="line"><span class="lineno">  609</span>                    <span class="keywordflow">if</span> (result.count_warnings() &gt; 0) {</div>
<div class="line"><span class="lineno">  610</span>                        std::cout &lt;&lt; <span class="stringliteral">&quot;\nWarnings:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  611</span>                        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; issue : result.get_issues(TemplateValidationLevel::WARNING)) {</div>
<div class="line"><span class="lineno">  612</span>                            std::cout &lt;&lt; <span class="stringliteral">&quot;  - &quot;</span> &lt;&lt; issue.to_string() &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  613</span>                        }</div>
<div class="line"><span class="lineno">  614</span>                    }</div>
<div class="line"><span class="lineno">  615</span>                    </div>
<div class="line"><span class="lineno">  616</span>                    <span class="comment">// print info messages</span></div>
<div class="line"><span class="lineno">  617</span>                    <span class="keywordflow">if</span> (result.count_infos() &gt; 0) {</div>
<div class="line"><span class="lineno">  618</span>                        std::cout &lt;&lt; <span class="stringliteral">&quot;\nInfo:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  619</span>                        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; issue : result.get_issues(TemplateValidationLevel::INFO)) {</div>
<div class="line"><span class="lineno">  620</span>                            std::cout &lt;&lt; <span class="stringliteral">&quot;  - &quot;</span> &lt;&lt; issue.to_string() &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  621</span>                        }</div>
<div class="line"><span class="lineno">  622</span>                    }</div>
<div class="line"><span class="lineno">  623</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  624</span>                    Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Template validated successfully with no issues&quot;</span>);</div>
<div class="line"><span class="lineno">  625</span>                }</div>
<div class="line"><span class="lineno">  626</span>            } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno">  627</span>                Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;Error validating template: &quot;</span>, e.what());</div>
<div class="line"><span class="lineno">  628</span>            }</div>
<div class="line"><span class="lineno">  629</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line == <span class="stringliteral">&quot;template validateall&quot;</span>) {</div>
<div class="line"><span class="lineno">  630</span>            <span class="comment">// validate all templates</span></div>
<div class="line"><span class="lineno">  631</span>            <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  632</span>                <span class="keyword">auto</span> templates = template_manager.list_templates();</div>
<div class="line"><span class="lineno">  633</span>                </div>
<div class="line"><span class="lineno">  634</span>                <span class="keywordflow">if</span> (templates.empty()) {</div>
<div class="line"><span class="lineno">  635</span>                    Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;No templates found to validate&quot;</span>);</div>
<div class="line"><span class="lineno">  636</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  637</span>                    std::cout &lt;&lt; <span class="stringliteral">&quot;Validating &quot;</span> &lt;&lt; templates.size() &lt;&lt; <span class="stringliteral">&quot; templates...&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  638</span>                    std::cout &lt;&lt; <span class="stringliteral">&quot;----------------------------&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  639</span>                    </div>
<div class="line"><span class="lineno">  640</span>                    <span class="keywordtype">size_t</span> error_count = 0;</div>
<div class="line"><span class="lineno">  641</span>                    <span class="keywordtype">size_t</span> warning_count = 0;</div>
<div class="line"><span class="lineno">  642</span>                    <span class="keywordtype">size_t</span> info_count = 0;</div>
<div class="line"><span class="lineno">  643</span>                    </div>
<div class="line"><span class="lineno">  644</span>                    <span class="comment">// keep track of templates with issues</span></div>
<div class="line"><span class="lineno">  645</span>                    std::vector&lt;std::string&gt; templates_with_errors;</div>
<div class="line"><span class="lineno">  646</span>                    std::vector&lt;std::string&gt; templates_with_warnings;</div>
<div class="line"><span class="lineno">  647</span>                    </div>
<div class="line"><span class="lineno">  648</span>                    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; tmpl : templates) {</div>
<div class="line"><span class="lineno">  649</span>                        <span class="keyword">auto</span> result = template_validator.validate_template(tmpl);</div>
<div class="line"><span class="lineno">  650</span>                        </div>
<div class="line"><span class="lineno">  651</span>                        <span class="comment">// count issues</span></div>
<div class="line"><span class="lineno">  652</span>                        error_count += result.count_errors();</div>
<div class="line"><span class="lineno">  653</span>                        warning_count += result.count_warnings();</div>
<div class="line"><span class="lineno">  654</span>                        info_count += result.count_infos();</div>
<div class="line"><span class="lineno">  655</span>                        </div>
<div class="line"><span class="lineno">  656</span>                        <span class="comment">// print progress</span></div>
<div class="line"><span class="lineno">  657</span>                        <span class="keywordflow">if</span> (result.has_issues(TemplateValidationLevel::ERROR)) {</div>
<div class="line"><span class="lineno">  658</span>                            templates_with_errors.push_back(tmpl);</div>
<div class="line"><span class="lineno">  659</span>                            std::cout &lt;&lt; <span class="stringliteral">&quot;❌ &quot;</span> &lt;&lt; tmpl &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; result.count_errors() &lt;&lt; <span class="stringliteral">&quot; errors, &quot;</span></div>
<div class="line"><span class="lineno">  660</span>                                      &lt;&lt; result.count_warnings() &lt;&lt; <span class="stringliteral">&quot; warnings&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  661</span>                        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (result.has_issues(TemplateValidationLevel::WARNING)) {</div>
<div class="line"><span class="lineno">  662</span>                            templates_with_warnings.push_back(tmpl);</div>
<div class="line"><span class="lineno">  663</span>                            std::cout &lt;&lt; <span class="stringliteral">&quot;⚠️ &quot;</span> &lt;&lt; tmpl &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; result.count_warnings() &lt;&lt; <span class="stringliteral">&quot; warnings&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  664</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  665</span>                            std::cout &lt;&lt; <span class="stringliteral">&quot;✅ &quot;</span> &lt;&lt; tmpl &lt;&lt; <span class="stringliteral">&quot;: No issues&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  666</span>                        }</div>
<div class="line"><span class="lineno">  667</span>                    }</div>
<div class="line"><span class="lineno">  668</span>                    </div>
<div class="line"><span class="lineno">  669</span>                    <span class="comment">// print summary</span></div>
<div class="line"><span class="lineno">  670</span>                    std::cout &lt;&lt; <span class="stringliteral">&quot;\nValidation Summary:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  671</span>                    std::cout &lt;&lt; <span class="stringliteral">&quot;----------------------------&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  672</span>                    std::cout &lt;&lt; <span class="stringliteral">&quot;Templates validated: &quot;</span> &lt;&lt; templates.size() &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  673</span>                    std::cout &lt;&lt; <span class="stringliteral">&quot;Total issues: &quot;</span> &lt;&lt; (error_count + warning_count + info_count) &lt;&lt; <span class="stringliteral">&quot; (&quot;</span></div>
<div class="line"><span class="lineno">  674</span>                              &lt;&lt; error_count &lt;&lt; <span class="stringliteral">&quot; errors, &quot;</span> </div>
<div class="line"><span class="lineno">  675</span>                              &lt;&lt; warning_count &lt;&lt; <span class="stringliteral">&quot; warnings, &quot;</span> </div>
<div class="line"><span class="lineno">  676</span>                              &lt;&lt; info_count &lt;&lt; <span class="stringliteral">&quot; info messages)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  677</span>                    </div>
<div class="line"><span class="lineno">  678</span>                    <span class="comment">// list templates with errors</span></div>
<div class="line"><span class="lineno">  679</span>                    <span class="keywordflow">if</span> (!templates_with_errors.empty()) {</div>
<div class="line"><span class="lineno">  680</span>                        std::cout &lt;&lt; <span class="stringliteral">&quot;\nTemplates with errors:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  681</span>                        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; tmpl : templates_with_errors) {</div>
<div class="line"><span class="lineno">  682</span>                            std::cout &lt;&lt; <span class="stringliteral">&quot;  - &quot;</span> &lt;&lt; tmpl &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  683</span>                        }</div>
<div class="line"><span class="lineno">  684</span>                        std::cout &lt;&lt; <span class="stringliteral">&quot;Run &#39;template validate &lt;n&gt;&#39; for details&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  685</span>                    }</div>
<div class="line"><span class="lineno">  686</span>                    </div>
<div class="line"><span class="lineno">  687</span>                    <span class="keywordflow">if</span> (error_count &gt; 0) {</div>
<div class="line"><span class="lineno">  688</span>                        Logger::getInstance().log(LogLevel::ERROR, </div>
<div class="line"><span class="lineno">  689</span>                            <span class="stringliteral">&quot;Validation found &quot;</span>, error_count, <span class="stringliteral">&quot; errors in &quot;</span>, templates_with_errors.size(), <span class="stringliteral">&quot; template(s)&quot;</span>);</div>
<div class="line"><span class="lineno">  690</span>                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (warning_count &gt; 0) {</div>
<div class="line"><span class="lineno">  691</span>                        Logger::getInstance().log(LogLevel::NORMAL, </div>
<div class="line"><span class="lineno">  692</span>                            <span class="stringliteral">&quot;Validation found &quot;</span>, warning_count, <span class="stringliteral">&quot; warnings in &quot;</span>, templates_with_warnings.size(), <span class="stringliteral">&quot; template(s)&quot;</span>);</div>
<div class="line"><span class="lineno">  693</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  694</span>                        Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;All templates validated successfully&quot;</span>);</div>
<div class="line"><span class="lineno">  695</span>                    }</div>
<div class="line"><span class="lineno">  696</span>                }</div>
<div class="line"><span class="lineno">  697</span>            } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno">  698</span>                Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;Error validating templates: &quot;</span>, e.what());</div>
<div class="line"><span class="lineno">  699</span>            }</div>
<div class="line"><span class="lineno">  700</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line.substr(0, 14) == <span class="stringliteral">&quot;template docs &quot;</span>) {</div>
<div class="line"><span class="lineno">  701</span>            <span class="comment">// generate documentation for a specific template</span></div>
<div class="line"><span class="lineno">  702</span>            std::string template_name = line.substr(14);</div>
<div class="line"><span class="lineno">  703</span>            <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  704</span>                <span class="comment">// generate the documentation</span></div>
<div class="line"><span class="lineno">  705</span>                std::string docs = template_manager.generate_template_documentation(template_name);</div>
<div class="line"><span class="lineno">  706</span>                </div>
<div class="line"><span class="lineno">  707</span>                <span class="comment">// display the documentation</span></div>
<div class="line"><span class="lineno">  708</span>                std::cout &lt;&lt; <span class="stringliteral">&quot;\n===== Template Documentation =====\n\n&quot;</span>;</div>
<div class="line"><span class="lineno">  709</span>                std::cout &lt;&lt; docs &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  710</span>                std::cout &lt;&lt; <span class="stringliteral">&quot;\n==================================&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  711</span>                </div>
<div class="line"><span class="lineno">  712</span>                Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;generated documentation for template: &quot;</span>, template_name);</div>
<div class="line"><span class="lineno">  713</span>            } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno">  714</span>                Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;error generating template documentation: &quot;</span>, e.what());</div>
<div class="line"><span class="lineno">  715</span>            }</div>
<div class="line"><span class="lineno">  716</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line == <span class="stringliteral">&quot;template docsall&quot;</span>) {</div>
<div class="line"><span class="lineno">  717</span>            <span class="comment">// generate documentation for all templates</span></div>
<div class="line"><span class="lineno">  718</span>            <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  719</span>                <span class="comment">// generate the documentation</span></div>
<div class="line"><span class="lineno">  720</span>                std::string docs = template_manager.generate_all_template_documentation();</div>
<div class="line"><span class="lineno">  721</span>                </div>
<div class="line"><span class="lineno">  722</span>                <span class="comment">// display the documentation</span></div>
<div class="line"><span class="lineno">  723</span>                std::cout &lt;&lt; <span class="stringliteral">&quot;\n===== Template Documentation =====\n\n&quot;</span>;</div>
<div class="line"><span class="lineno">  724</span>                std::cout &lt;&lt; <span class="stringliteral">&quot;this is a preview of the documentation. use &#39;template export&#39; to save to a file.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  725</span>                std::cout &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span> &lt;&lt; docs.substr(0, 1000) &lt;&lt; <span class="stringliteral">&quot;...&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  726</span>                std::cout &lt;&lt; <span class="stringliteral">&quot;\n(documentation truncated for display. use &#39;template export&#39; to view full documentation)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  727</span>                std::cout &lt;&lt; <span class="stringliteral">&quot;\n==================================&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  728</span>                </div>
<div class="line"><span class="lineno">  729</span>                Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;generated documentation for all templates&quot;</span>);</div>
<div class="line"><span class="lineno">  730</span>            } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno">  731</span>                Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;error generating template documentation: &quot;</span>, e.what());</div>
<div class="line"><span class="lineno">  732</span>            }</div>
<div class="line"><span class="lineno">  733</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line.substr(0, 16) == <span class="stringliteral">&quot;template export &quot;</span>) {</div>
<div class="line"><span class="lineno">  734</span>            <span class="comment">// export documentation to a file</span></div>
<div class="line"><span class="lineno">  735</span>            std::string params = line.substr(16);</div>
<div class="line"><span class="lineno">  736</span>            std::string output_path;</div>
<div class="line"><span class="lineno">  737</span>            std::string format = <span class="stringliteral">&quot;markdown&quot;</span>; <span class="comment">// default format</span></div>
<div class="line"><span class="lineno">  738</span>            </div>
<div class="line"><span class="lineno">  739</span>            <span class="comment">// check if a format is specified</span></div>
<div class="line"><span class="lineno">  740</span>            <span class="keywordtype">size_t</span> space_pos = params.find(<span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"><span class="lineno">  741</span>            <span class="keywordflow">if</span> (space_pos != std::string::npos) {</div>
<div class="line"><span class="lineno">  742</span>                output_path = params.substr(0, space_pos);</div>
<div class="line"><span class="lineno">  743</span>                format = params.substr(space_pos + 1);</div>
<div class="line"><span class="lineno">  744</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  745</span>                output_path = params;</div>
<div class="line"><span class="lineno">  746</span>            }</div>
<div class="line"><span class="lineno">  747</span>            </div>
<div class="line"><span class="lineno">  748</span>            <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  749</span>                <span class="comment">// export the documentation</span></div>
<div class="line"><span class="lineno">  750</span> </div>
<div class="line"><span class="lineno">  751</span>                <span class="keywordflow">if</span> (template_manager.export_documentation(output_path, format)) {</div>
<div class="line"><span class="lineno">  752</span>                    Logger::getInstance().log(LogLevel::INFO, </div>
<div class="line"><span class="lineno">  753</span>                        <span class="stringliteral">&quot;template documentation exported to &quot;</span>, output_path, <span class="stringliteral">&quot; in &quot;</span>, format, <span class="stringliteral">&quot; format&quot;</span>);</div>
<div class="line"><span class="lineno">  754</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  755</span>                    Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;failed to export template documentation&quot;</span>);</div>
<div class="line"><span class="lineno">  756</span>                }</div>
<div class="line"><span class="lineno">  757</span>            } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno">  758</span>                Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;error exporting template documentation: &quot;</span>, e.what());</div>
<div class="line"><span class="lineno">  759</span>            }</div>
<div class="line"><span class="lineno">  760</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  761</span>            <span class="comment">// add line to the current query</span></div>
<div class="line"><span class="lineno">  762</span>            <span class="keywordflow">if</span> (!current_query.empty()) {</div>
<div class="line"><span class="lineno">  763</span>                current_query += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  764</span>            }</div>
<div class="line"><span class="lineno">  765</span>            current_query += line;</div>
<div class="line"><span class="lineno">  766</span>        }</div>
<div class="line"><span class="lineno">  767</span>    }</div>
<div class="line"><span class="lineno">  768</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="util_8cpp_source.html#l00015">cql::util::read_file()</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8cpp_source.html#l00044">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><!-- SVG 8 --></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><!-- SVG 9 --></div>
</div>

</div>
</div>
<a id="a7b229a6d1cbd174fe79d903ee74dcbab" name="a7b229a6d1cbd174fe79d903ee74dcbab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b229a6d1cbd174fe79d903ee74dcbab">&#9670;&#160;</a></span>save_generated_files()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cql::cli::save_generated_files </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; GeneratedFile &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>files</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Config &amp;</td>          <td class="paramname"><span class="paramname"><em>config</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cli_8cpp_source.html#l00865">865</a> of file <a class="el" href="cli_8cpp_source.html">cli.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  865</span>                                                                                       {</div>
<div class="line"><span class="lineno">  866</span>    <span class="comment">// Skip saving if no-save mode is enabled</span></div>
<div class="line"><span class="lineno">  867</span>    <span class="keywordflow">if</span> (config.no_save_mode()) {</div>
<div class="line"><span class="lineno">  868</span>        Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Files not saved (--no-save option used)&quot;</span>);</div>
<div class="line"><span class="lineno">  869</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Files not saved (--no-save option used)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  870</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  871</span>    }</div>
<div class="line"><span class="lineno">  872</span>    </div>
<div class="line"><span class="lineno">  873</span>    <span class="comment">// Save each file</span></div>
<div class="line"><span class="lineno">  874</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; file : files) {</div>
<div class="line"><span class="lineno">  875</span>        <a class="code hl_function" href="namespacecql.html#adf99c8a0ad539b1c9ec49e7744ea7468">save_generated_file</a>(file, config.get_output_directory(), config);</div>
<div class="line"><span class="lineno">  876</span>    }</div>
<div class="line"><span class="lineno">  877</span>    </div>
<div class="line"><span class="lineno">  878</span>    <span class="comment">// Log where files were saved</span></div>
<div class="line"><span class="lineno">  879</span>    <span class="keywordflow">if</span> (!config.get_output_directory().empty()) {</div>
<div class="line"><span class="lineno">  880</span>        Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Files saved to &quot;</span>, config.get_output_directory());</div>
<div class="line"><span class="lineno">  881</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Files saved to &quot;</span> &lt;&lt; config.get_output_directory() &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  882</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  883</span>        Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Files saved to current directory&quot;</span>);</div>
<div class="line"><span class="lineno">  884</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Files saved to current directory&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  885</span>    }</div>
<div class="line"><span class="lineno">  886</span>}</div>
<div class="ttc" id="anamespacecql_html_adf99c8a0ad539b1c9ec49e7744ea7468"><div class="ttname"><a href="namespacecql.html#adf99c8a0ad539b1c9ec49e7744ea7468">cql::save_generated_file</a></div><div class="ttdeci">bool save_generated_file(const GeneratedFile &amp;file, const std::string &amp;directory, const Config &amp;config)</div><div class="ttdef"><b>Definition</b> <a href="response__processor_8cpp_source.html#l00451">response_processor.cpp:451</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="response__processor_8cpp_source.html#l00451">cql::save_generated_file()</a>.</p>

<p class="reference">Referenced by <a class="el" href="cli_8cpp_source.html#l00889">process_submit_command()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><!-- SVG 10 --></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><!-- SVG 11 --></div>
</div>

</div>
</div>
<a id="ae821ee6e0823797bed800b41db27f4ce" name="ae821ee6e0823797bed800b41db27f4ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae821ee6e0823797bed800b41db27f4ce">&#9670;&#160;</a></span>submit_to_api()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ApiResponse cql::cli::submit_to_api </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em>compiled_query</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Config &amp;</td>          <td class="paramname"><span class="paramname"><em>config</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cli_8cpp_source.html#l00830">830</a> of file <a class="el" href="cli_8cpp_source.html">cli.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  830</span>                                                                                 {</div>
<div class="line"><span class="lineno">  831</span>    Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;Submitting to Claude API...&quot;</span>);</div>
<div class="line"><span class="lineno">  832</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;Submitting to Claude API (model: &quot;</span> &lt;&lt; config.get_model() &lt;&lt; <span class="stringliteral">&quot;)...&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  833</span>    </div>
<div class="line"><span class="lineno">  834</span>    ApiClient api_client(config);</div>
<div class="line"><span class="lineno">  835</span>    ApiResponse response = api_client.submit_query(compiled_query);</div>
<div class="line"><span class="lineno">  836</span>    </div>
<div class="line"><span class="lineno">  837</span>    <span class="keywordflow">if</span> (!response.m_success) {</div>
<div class="line"><span class="lineno">  838</span>        Logger::getInstance().log(LogLevel::ERROR, <span class="stringliteral">&quot;API request failed: &quot;</span>, response.m_error_message);</div>
<div class="line"><span class="lineno">  839</span>        std::cerr &lt;&lt; <span class="stringliteral">&quot;API request failed: &quot;</span> &lt;&lt; response.m_error_message &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  840</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  841</span>        Logger::getInstance().log(LogLevel::INFO, <span class="stringliteral">&quot;API request successful&quot;</span>);</div>
<div class="line"><span class="lineno">  842</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;API request successful&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  843</span>    }</div>
<div class="line"><span class="lineno">  844</span>    </div>
<div class="line"><span class="lineno">  845</span>    <span class="keywordflow">return</span> response;</div>
<div class="line"><span class="lineno">  846</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="cli_8cpp_source.html#l00889">process_submit_command()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><!-- SVG 12 --></div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacecql.html">cql</a></li><li class="navelem"><a class="el" href="namespacecql_1_1cli.html">cli</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
